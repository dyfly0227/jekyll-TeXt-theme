---
title: '面试-移动开发'
excerpt: '移动端兼容问题，适配问题，以及jsBridge和DsBridge的原理'
tags: '面试'
---

### 移动端兼容问题
1. 当父元素设置了`transform: xxx`后，自身的`position: fixed`会失效，原因未知
2. 移动端弹窗滚动穿透。解：弹窗出现时给`body`添加`class`，
	```css
		.dialog-open {
			position: fixed;
			width: 100%;
		}	
	```
3. IOS设备中，设置了`position:fixed`的元素的`z-index`生效问题，并不是绝对的值比较，受兄弟元素和直系父元素影响
4. IOS设备视频不支持循环播放。解：监听`ended`时间，手动触发播放
5. 1px边框问题（在手机上看太宽了）。解：使用`:after,:before`伪类生成`1px`边框，之后用`scale(0.5)`将它变细
6. 安卓`border-radius:50%`不生效。解：直接设置具体px数值
7. 安卓`input`的`placeholder`偏上。解：`input { line-height: normal; }`
8. IOS滚动不流畅。解：`-webkit-overflow-scrolling: touch`
9. IOS设备键盘弹起后，页面的fixed会失效，滚动时会出现页面错乱。解决方案：将body的滚动区域转移到容器内部，即将主体内容放在`div`中
10. 点击穿透问题。解：使用`fastclick`库
11. 键盘遮挡问题。解：`element.scrolltoView()`，如遮挡固定定位弹窗，可监听window.onresize事件改变元素top
12. IOS日期转换出现NAN。解：用`new Date('2020/11/12 00:00:00')`
13. IOS滚动时动画停止。解：使用`better-scroll`库
14. 长按闪退。解：`-webkit-touch-callout: none;`
15. 禁止数字识别为电话号码。` <meta name = "format-detection" content = "telephone=no">`
17. transition闪屏。
	```css
	 .box { 
	       -webkit-transform-style: preserve-3d; 
	       -webkit-backface-visibility: hidden; 
	       -webkit-perspective: 1000; 
	  }
	```
18. IOS设备安全区
	```css
	body {
	  padding-bottom: constant(safe-area-inset-bottom);
	  padding-bottom: env(safe-area-inset-bottom);
	}
	```
### 移动端适配方案
设置viewport
```html
<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=no, minimum-sacle=1, maximum-scale=1" >
```
1. 使用rem布局`1 rem`等于根节点的字体大小，配合阿里适配方案或者
	```javascript
	function setRem() {
	   // 当前页面宽度相对于 750 宽的缩放比例，可根据自己需要修改
	    const scale = document.documentElement.clientWidth / 750;
	    document.documentElement.style.fontSize = scale + 'px';
	}
	```
    **优点**：不同屏幕元素大小比例一致		
	**缺点**：大屏看起来就很大

2. vh/vw布局
    **优点**：不同尺寸填满屏幕		
	**缺点**：大屏看起来就很大，且无法通过JS干预
3. 百分比布局
4. 响应式布局（媒体查询）

> **最终方案：px为主，搭配VH/VW、媒体查询与flex布局**

### 小程序开发
1. 小程序目录
	```
	WXML -- 模板文件
	JSON -- 配置文件
	WXSS -- 样式
	JS -- 逻辑处理
	app.json -- 配置文件入口，全局配置、底部tab、页面路径
	app.js -- 生命周期监听、全局变量
	app.wxss -- 全样式
	```
2. 生命周期
	```
	onLoad -- 页面加载
	onShow -- 每次打开页面都调用
	onReady -- 初次渲染完成
	onHide -- 页面隐藏
	onUnload -- 页面卸载
	```
3. 参数传递
	```
	app.js全局设置
	跳转时携带参数
	存储在本地
	```
5. 小程序的双向绑定，必须调用`this.setData()`才能同步到视图
6. 通过`data-*`来传递需要的值，获取`e.currentTarget.dataset`
7. 小程序页面跳转
	```
	wx.navigateTo -- 不能跳转到tabbar页面
	wx.redirectTo  -- 不能跳转到tabbar页面
	wx.switchTab -- 跳转到tabbar页面，并关闭其他非tabbar页面
	wx.navigateBack -- 可通过getCurrentPages()获取页面栈，决定需要返回几层
	wx.relaunch -- 关闭所有页面，打开到应用内的某个页面
	```
8. 优缺点
	**优点**：无需下载，打开速度快，开发成本低，服务器请求快
	**缺点**：依托微信，大小不能超过2M

### JSBridge 和 DSBridge
![在这里插入图片描述](/assets/images/f2213f5723e24f3f963bd90b84ca277f.png)

