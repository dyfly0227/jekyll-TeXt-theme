---
title: 'electron请求媒体文件'
excerpt: 'electron劫持请求，返回媒体文件'
tags: 'electron'
---

请求劫持，为了更方便的让客户端向服务端获取媒体文件

```ts
// 包装media请求协议，以便在node端劫持
export const getFile = (path: string) => {
  return 'atom:///' + path
}
```
```ts
// Node端劫持atom请求，并将请求引向正确地址
protocol.registerFileProtocol('atom', (request, callback) => {
  const url = request.url.slice(8)
  const host = getAppDataPath() // 获取当前应用文件位置，该方法在electron文件上传中有
  console.log(path.join(host, 'media', url))
  callback({
    path: path.join(host, 'media', url)
  })
})
```