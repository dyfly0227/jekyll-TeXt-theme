---
title: 'gin开启http'
excerpt: '开启HTTP服务以及路由配置'
tags: 'go'
---

```go
package Router

import (
	"github.com/gin-contrib/cors"
	"github.com/gin-gonic/gin"
	"go-service/src/Controller"
	"time"
)

func StartRouter() {
	router := gin.Default()
	// 配置跨域
	router.Use(cors.New(cors.Config{
		AllowOrigins:     []string{"http://localhost:8080"},
		AllowMethods:     []string{"PUT", "PATCH", "POST", "GET", "DELETE"},
		AllowHeaders:     []string{"Origin", "Authorization", "Content-Type", "X-Access-Token"},
		ExposeHeaders:    []string{"Content-Type"},
		AllowCredentials: true,
		AllowOriginFunc: func(origin string) bool {
			return true
		},
		MaxAge: 12 * time.Hour,
	}))
	// 路由配置
	configRoute(router)
	router.Run(":8082")
}
func configRoute(this *gin.Engine) {
	og := this.Group("og")
	{
		og.POST("/user/login", Controller.UserControl.Login)
	}
	loop := this.Group("go")
	// 增加请求拦截，判断身份
	loop.Use(AuthRequired())
	{
		loop.POST("/user/changePwd", Controller.UserControl.ChangePwd)
		loop.POST("/user/list", Controller.UserControl.UserList)
		loop.POST("/user/edit", Controller.UserControl.UserEdit)
		loop.POST("/user/del", Controller.UserControl.UserDel)
	}
}
func AuthRequired() gin.HandlerFunc {
	return func(c *gin.Context) {
		// 根据token判断身份信息
		_, err := Controller.GetCurUserinfo(c)
		if err != nil {
			c.Abort()
		}
		c.Next()
	}
}

```